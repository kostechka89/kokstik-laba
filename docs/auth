Ролевая модель строится вокруг трёх ролей: обычный пользователь, автор и администратор. У пользователя могут быть установлены два флага: verified_author и is_admin. Автором считается пользователь с флагом verified_author=True, администратором – is_admin=True.

— Автор или администратор может создавать новости. При создании новости автором идентификатор автора берётся из токена. Обычный пользователь без флага verified_author создавать новости не может.

— Редактировать или удалять новость может только её автор либо администратор. Для этого при обновлении или удалении проверяется, что текущий пользователь совпадает с автором записи или имеет права администратора.

— Комментарии могут создавать все аутентифицированные пользователи. Редактировать и удалять комментарии может только автор комментария или администратор.

— Список пользователей и операции над учётными записями доступны только администратору. Пользователь может просматривать и изменять только собственную учётную запись, не затрагивая флаги verified_author и is_admin.

Для авторизации используется JWT. Два типа токенов: access и refresh. Access‑токен содержит идентификатор пользователя и его права и живёт ограниченное время. Refresh‑токен используется для получения нового access‑токена. При создании refresh‑токена в Redis сохраняется запись о сессии пользователя с уникальным идентификатором (jti), user_agent и временем истечения. При выходе из системы или при обновлении токена старый jti удаляется, а новый создаётся. Пользователь может получить список своих активных сессий через ручку /auth/sessions.

Кэширование реализовано через Redis. Для ускорения чтения новости каждая запись кэшируется по ключу news:<id> сроком на пять минут. При запросе новости сначала проверяется кэш, затем база данных; после чтения из базы запись помещается в кэш. При создании, обновлении или удалении новости кэш обновляется или инвалидируется. Данные пользователей без чувствительных полей также помещаются в Redis под ключом user:<id> для ускорения проверки прав.